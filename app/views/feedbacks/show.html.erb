<div style="max-width: 650px; margin: 60px auto; padding: 60px; background: #fff; border: 1px solid #eee; font-family: 'Helvetica Neue', Arial, sans-serif; color: #1a1a1a; line-height: 1.8;">

  <%# „Éò„ÉÉ„ÉÄ„Éº„Çª„ÇØ„Ç∑„Éß„É≥Ôºà‰∏≠Â§ÆÂØÑ„ÅõÔºâ %>
  <div style="text-align: center; margin-bottom: 60px;">
    <h2 style="font-size: 22px; font-weight: 200; letter-spacing: 0.3em; margin: 0 0 20px 0; color: #1a1a1a; text-transform: uppercase;">
      <%= @feedback.title.present? ? @feedback.title : "LESSON FEEDBACK" %>
    </h2>
    <div style="width: 40px; height: 1px; background: #1a1a1a; margin: 0 auto;"></div>
  </div>

  <%# Êó•‰ªò„Å®ÊôÇÈñìÔºàjustify-content: center„ÇíËøΩÂä†„Åó„Å¶‰∏≠Â§ÆÂØÑ„Åõ„Å´Ôºâ %>
  <div style="font-size: 11px; color: #999; letter-spacing: 0.2em; margin-bottom: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 25px; border-bottom: 1px solid #f0f0f0; padding-bottom: 15px;">
    <div style="display: flex; align-items: center; gap: 8px;">
      <span style="color: #ccc;">DATE</span>
      <span style="color: #1a1a1a;"><%= @feedback.lesson_date.strftime("%Y.%m.%d") %></span>
    </div>

    <% if @feedback.hour.present? || @feedback.minute.present? %>
      <div style="display: flex; align-items: center; gap: 8px;">
        <span style="color: #ccc;">TIME</span>
        <span style="color: #1a1a1a;">
          <% if @feedback.hour.to_i > 0 %>
            <%= @feedback.hour %> <span style="font-size: 9px; margin-right: 5px;">HR</span>
          <% end %>
          <% if @feedback.minute.to_i > 0 %>
            <%= @feedback.minute %> <span style="font-size: 9px;">MIN</span>
          <% end %>
        </span>
      </div>
    <% end %>
  </div>

  <%# „Ç§„É≥„Éï„Ç©„É°„Éº„Ç∑„Éß„É≥Ôºà„Åì„Åì„ÅØÂ∑¶Âè≥„Å´ÊåØ„ÇäÂàÜ„ÅëÔºâ %>
  <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-bottom: 40px; letter-spacing: 0.05em;">
    <div>STUDENT : <%= link_to @feedback.student.name, user_path(@feedback.student), style: "color: #1a1a1a; text-decoration: none; border-bottom: 1px solid #eee;" %></div>
    <div>TEACHER : <%= link_to @feedback.teacher.name, user_path(@feedback.teacher), style: "color: #1a1a1a; text-decoration: none; border-bottom: 1px solid #eee;" %></div>
  </div>

  <%# „Çπ„Ç≥„Ç¢ %>
  <% if @feedback.rating.present? %>
    <div style="margin-bottom: 50px; text-align: center;">
      <div style="font-size: 10px; color: #999; letter-spacing: 0.2em; margin-bottom: 5px;">Êú¨Êó•„ÅÆÁêÜËß£Â∫¶</div>
      <div style="font-size: 32px; font-family: 'Georgia', serif; font-weight: 300;">
        <%= @feedback.rating %><span style="font-size: 14px; color: #ccc; margin-left: 5px;">/ 5</span>
      </div>
    </div>
  <% end %>

  <%# È†ÖÁõÆÂà•„ÉÅ„Çß„ÉÉ„ÇØ %>
  <% if @feedback.check_items.any? %>
    <div style="margin-bottom: 50px;">
      <div style="font-size: 11px; color: #999; letter-spacing: 0.1em; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 20px;">CHECK POINTS</div>
      <% @feedback.check_items.each do |item| %>
        <div style="display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid #f9f9f9;">
          <% if item.timestamp.present? %>
            <span style="font-size: 10px; color: #999; font-family: 'Georgia', serif; width: 50px;"><%= item.timestamp %></span>
          <% end %>
          <span style="flex-grow: 1; font-size: 14px; letter-spacing: 0.05em;"><%= item.name %></span>
          <span style="font-size: 16px; color: #1a1a1a; margin-left: 20px;"><%= item.result %></span>
        </div>
      <% end %>
      <div style="margin-top: 40px; text-align: center;">
        <% if current_user.student? %>
          <%= link_to "RECORD TIME („Çø„Ç§„É†„ÇíË®òÈå≤„Åô„Çã)", edit_feedback_path(@feedback), style: "font-size: 11px; background: #1a1a1a; color: #fff; text-decoration: none; padding: 12px 30px; letter-spacing: 0.1em;" %>
        <% end %>
      </div>
    </div>
  <% end %>

  <%# „É°„Ç§„É≥„É°„ÉÉ„Çª„Éº„Ç∏ %>
  <div style="font-size: 15px; color: #1a1a1a; white-space: pre-wrap; margin-bottom: 60px; min-height: 150px;">
    <%= @feedback.content %>
  </div>

  <%# „ÅÑ„ÅÑ„Å≠„Çª„ÇØ„Ç∑„Éß„É≥ %>
  <div id="like-section" style="margin-top: 20px; text-align: center;">
    <% if @feedback.liked_by?(current_user) %>
      <%= button_to feedback_likes_path(@feedback), method: :delete, style: "background: none; border: none; cursor: pointer; font-size: 18px;" do %>
        <span style="color: #ff4b5c;">üñ§</span>
      <% end %>
    <% else %>
      <%= button_to feedback_likes_path(@feedback), method: :post, style: "background: none; border: none; cursor: pointer; font-size: 18px;" do %>
        <span style="color: #ccc;">ü§ç</span>
      <% end %>
    <% end %>
    <div style="margin-top: 10px;">
      <p style="font-size: 11px; color: #1a1a1a; letter-spacing: 0.1em; font-weight: bold;"><%= @feedback.likes.count %> LIKES</p>
      <% if @feedback.likes.any? %>
        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 8px;">
          <% @feedback.likes.each do |like| %>
            <span style="font-size: 9px; color: #999; border: 1px solid #eee; padding: 2px 6px; border-radius: 10px;"><%= like.user.name %></span>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <%# „Ç≥„É°„É≥„Éà„Çª„ÇØ„Ç∑„Éß„É≥Ôºà„Åì„Åì„Åå„Éù„Ç§„É≥„ÉàÔºÅÔºâ %>
  <div style="margin-top: 40px; border-top: 1px solid #eee; padding-top: 20px;">
    <%# „Çø„Ç§„Éà„É´„ÇÇ‰∏≠Â§Æ„Å∏ %>
    <h3 style="font-size: 14px; letter-spacing: 0.1em; color: #666; text-align: center; margin-bottom: 30px;">COMMENTS</h3>

    <div style="margin-bottom: 30px;">
      <% @feedback.comments.each do |comment| %>
        <%# „Ç≥„É°„É≥„Éà„ÅÆÁÆ±„ÅØË™≠„Åø„ÇÑ„Åô„Åï„ÅÆ„Åü„ÇÅÂ∑¶ÂØÑ„Åõ„ÅÆ„Åæ„Åæ„ÄÅ‰ΩôÁôΩ„ÇíË™øÊï¥ %>
        <div style="margin-bottom: 20px; padding: 15px; background: #fdfdfd; border: 1px solid #f5f5f5;">
          <p style="font-size: 11px; font-weight: bold; margin-bottom: 8px; display: flex; justify-content: space-between;">
            <span><%= comment.user.name %></span>
            <span style="font-weight: normal; color: #bbb;"><%= comment.created_at.strftime("%Y/%m/%d %H:%M") %></span>
          </p>
          <p style="font-size: 13px; line-height: 1.6; color: #444;"><%= comment.content %></p>
          
          <% if comment.user == current_user %>
            <div style="display: flex; gap: 10px; margin-top: 12px; align-items: center; border-top: 1px solid #f0f0f0; padding-top: 8px;">
              <%= link_to "EDIT", edit_feedback_comment_path(comment.feedback, comment), style: "color: #bbb; font-size: 10px; text-decoration: none; letter-spacing: 0.1em;" %>
              <span style="color: #eee; font-size: 10px;">|</span>
              <%= button_to "DELETE", [comment.feedback, comment], method: :delete, onclick: "return confirm('„Åì„ÅÆ„Ç≥„É°„É≥„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü');", style: "background: none; border: none; color: #bbb; font-size: 10px; cursor: pointer; padding: 0; letter-spacing: 0.1em; font-family: inherit;", form: { style: "display: inline; line-height: 1;" } %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>

    <%# „Ç≥„É°„É≥„Éà„Éï„Ç©„Éº„É† %>
    <%= form_with(model: [@feedback, @feedback.comments.build], local: true) do |f| %>
      <div style="margin-bottom: 15px;">
        <%= f.text_area :content, placeholder: "„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ...", style: "width: 100%; height: 80px; padding: 12px; border: 1px solid #eee; outline: none; font-size: 13px;" %>
      </div>
      <%# „Éú„Çø„É≥„Çí‰∏≠Â§Æ„Å´ÈÖçÁΩÆ %>
      <div style="text-align: center;">
        <%= f.submit "„Ç≥„É°„É≥„Éà„Åô„Çã", style: "background: #1a1a1a; color: #fff; border: none; padding: 10px 40px; font-size: 12px; cursor: pointer; letter-spacing: 0.1em;" %>
      </div>
    <% end %>
  </div>

  <%# „Éï„ÉÉ„Çø„Éº„Ç¢„ÇØ„Ç∑„Éß„É≥Ôºà‰∏≠Â§ÆÂØÑ„ÅõÔºâ %>
  <div style="margin-top: 60px; border-top: 1px solid #eee; padding-top: 40px; display: flex; justify-content: center; gap: 30px; align-items: center;">
    <% if current_user.teacher? %>
      <%= link_to "EDIT", edit_feedback_path(@feedback), style: "font-size: 11px; color: #1a1a1a; text-decoration: none; letter-spacing: 0.1em; border-bottom: 1px solid #1a1a1a;" %>
      <%= button_to "DELETE", feedback_path(@feedback), method: :delete, onclick: "return confirm('ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü');", style: "background: none; border: none; color: #999; font-size: 11px; cursor: pointer; padding: 0; letter-spacing: 0.1em;", form: { style: "display: inline;" } %>
      <%= link_to "BACK TO LIST", feedbacks_path, style: "font-size: 11px; color: #999; text-decoration: none;" %>
    <% else %>
      <%= link_to "BACK TO MYPAGE", mypage_path, style: "font-size: 11px; color: #1a1a1a; text-decoration: none; letter-spacing: 0.2em;" %>
    <% end %>
  </div>

  <%# Âç∞Âà∑„Éú„Çø„É≥„Çª„ÇØ„Ç∑„Éß„É≥Ôºà‰∏≠Â§ÆÂØÑ„ÅõÔºâ %>
  <div style="padding-top: 30px; display: flex; justify-content: center;">
    <button onclick="window.print()" style="background: none; color: #1a1a1a; border: 1px solid #1a1a1a; padding: 10px 40px; font-size: 10px; letter-spacing: 0.2em; cursor: pointer; font-family: inherit;">
      PRINT / PDF
    </button>
  </div>
</div>

<style>
  @media print {
    /* Âç∞Âà∑ÊôÇ„Å´„Éú„Çø„É≥„ÇÑ„É™„É≥„ÇØ„ÇíÈö†„Åô */
    button, a, .no-print {
      display: none !important;
    }
    
    /* Âç∞Âà∑ÊôÇ„ÅÆ‰ΩôÁôΩË™øÊï¥ */
    body {
      background: white !important;
    }
    div[style*="margin: 60px auto"] {
      margin: 0 !important;
      border: none !important;
      box-shadow: none !important;
      width: 100% !important;
      max-width: 100% !important;
    }
  }
</style>
